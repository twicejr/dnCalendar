!function(e){e.fn.dnCalendar=function(t){var a=e(this),n={},r=new Date,l=null,d=new Date,o=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],i=!1;Array.prototype.move=function(e,t){for(;e<0;)e+=this.length;for(;t<0;)t+=this.length;if(t>=this.length)for(var a=t-this.length;1+a--;)this.push(void 0);return this.splice(t,0,this.splice(e,1)[0]),this};var h=function(){for(var e=0;e<o.length;e++)if(o[e]==n.startWeek.toLowerCase())return e;return 0},s=function(e,t){var a=new Date(e,t-1,1),n=new Date(e,t,0),r=a.getDay()+n.getDate();return Math.ceil(r/7)},u=function(e,t){for(var a=[],n=new Date(t,e,1),r=new Date(t,e+1,0).getDate(),l=(h(),new Date(t,e,0).getDate()-n.getDay()),d=new Date(t,e+1,1).getDate(),o=1;o<=r;){for(var i=0,s=[];i<7;)0==a.length?i>=n.getDay()?(s.push(o),o++):(l++,s.push(l)):o<=r?(s.push(o),o++):s.push(d++),i++;a.push(s)}return a},g=function(e,t,a){function n(e,t){for(var a=!1,n=0;n<e.length;n++)if(e[n]==t){a=!0;break}return a}var r=h(),l=new Date(a,t,0).getDate(),d=new Date(a,t+1,0).getDate();if(r>0){for(var o=[],i=e.length,s=0;s<i;s++){b=[];if(0==s&&0==o.length){if(1==e[s][0]){for(var u=l-(7-r-1);u<=l;)b.push(u),u++;for(f=0;f<e[s].length;f++)b.length<e[s].length&&((y=n(b,D=e[s][f]))||b.push(D))}else for(f=0;f<e[s].length;f++)if(b.length<e[s].length)if(void 0!==e[s][f+r])b.push(e[s][f+r]);else if(void 0!==e[s+1])for(p=0;p<e[s+1].length;p++)b.length<e[s].length&&((y=n(b,D=e[s+1][p]))||b.push(D))}else for(var g=s;g>=0;g--)for(var v=!1,f=0;f<e[g].length;f++){w=o[m=o.length-1].length-1;if(o[m][w]==e[g][f]&&(v=!0),1==v)if(void 0!==e[g][f+r]){if(b.length<e[g].length&&!(y=n(b,D=e[g][f+r])))if(void 0!==b[b.length-1]){var c=b[b.length-1];c+1!=D&&c+1<d?b.push(c+1):b.push(e[g][f+r])}else b.push(e[g][f+r])}else if(void 0!==e[g+1])for(var p=0;p<e[g+1].length;p++)if(b.length<e[g].length){var D=e[g+1][p],y=n(b,D);y||b.push(D)}}o.push(b)}for(var v=!1,s=1;s<o.length;s++){for(f=0;f<o[s].length;f++)if(o[s][f]==d){v=!0;break}if(1==v)break}var m=o.length-1;if(0==v){for(var w=o[m].length-1,M=o[m][w],b=[];M<d;)M++,b.push(M);if(b.length<7)for(var k=7-b.length,F=1;F<=k;)b.push(F),F++;o.push(b)}else{var N=7-((w=o[m].length-1)+1);for((M=o[m][w])>7?M=1:M+=1;N>0;)o[m].push(M),M++,N--}return o}return e},v=function(){for(var t=r.getMonth(),o=r.getFullYear(),v=u(t,o),p=0;p<v.length;p++)for(var D="",y=0;y<v[p].length;y++)D+=v[p][y]+" ";v=g(v,t,o);for(p=0;p<v.length;p++)for(var D="",y=0;y<v[p].length;y++)D+=v[p][y]+" ";var m=n.monthNames[t];1==n.monthUseShortName&&(m=n.monthNamesShort[t]);var w=e("<div class='dncalendar-header'></div>");w.append("<h2>"+m+" "+o+"</h2>");var M=!1,b=null;if(void 0!==n.minDate){var k=n.minDate.split("-");(b=new Date(k[0],k[1]-1,k[2])).getFullYear()>=o&&b.getMonth()>=t&&(M=!0)}var F=!1,N=null;if(void 0!==n.maxDate){var C=n.maxDate.split("-");(N=new Date(C[0],C[1]-1,C[2])).getFullYear()<=o&&N.getMonth()<=t&&(F=!0)}var S=e("<div class='dncalendar-links'></div>"),Y=e("<div class='dncalendar-prev-month'></div>"),T=e("<div class='dncalendar-next-month'></div>");M&&(Y.addClass("dncalendar-inactive"),Y.removeAttr("id")),F&&(T.addClass("dncalendar-inactive"),T.removeAttr("id")),S.append(Y),S.append(T),w.append(S);var A=e("<div class='dncalendar-body'></div>"),x=e("<table></table>"),J=n.dayNames;1==n.dayUseShortName&&(J=n.dayNamesShort);var U=h();if(0==i){for(var W=null,O=0,p=0;p<J.length;p++)p>=U&&(null==W&&(W=p),J.move(W,O),W++,O++);i=!0}for(var j=0==U?0:7-U,L=6-U,Q=e("<thead></thead>"),q=e("<tr></tr>"),z=J.length,p=0;p<z;p++)q.append("<td "+(p==j||p==L?'class="holiday"':"")+">"+J[p]+"</td>");Q.append(q);var B=e("<tbody></tbody>"),E=(s(o,t+1),new Date(o,t,1));new Date(o,t+1,0),new Date(o,t,0).getDate(),E.getDay(),new Date(o,t+1,1).getDate();null!=b&&b.getDate();null!=N&&N.getDate();var G="today",H="default date";void 0!==n.dataTitles&&(void 0!==n.dataTitles.chosenDate&&(H=n.dataTitles.chosenDate),void 0!==n.dataTitles.today&&(G=n.dataTitles.today));for(var j=0==U?0:7-U,L=0==U?6:7-(U+1),I=v.length,p=0;p<I;p++){for(var K=e("<tr></tr>"),P=v[p].length,y=0;y<P;y++){var R=v[p][y],V=t+1,X=o,Z="",$="",_=!0;0==p&&v[p][y]>7&&(_=!1,(V-=1)<=0&&(V=12,X-=1)),p==I-1&&v[p][y]<=7&&(_=!1,(V+=1)>=12&&(V=1,X+=1)),d.getFullYear()==X&&d.getMonth()+1==V&&d.getDate()==R&&(Z=" today-date ",$="data-title='"+G+"'"),null!=l&&l.getFullYear()==X&&l.getMonth()+1==V&&l.getDate()==R&&(Z=" chosen-date ",$="data-title='"+H+"'"),y!=j&&y!=L||(Z+=" holiday "),void 0!==n.notes&&f(new Date(X,V-1,R))&&(Z+=" note ");var ee="<td class='calendarClickable "+Z+" "+(1==_?"active":"")+" calendarClick' data-date='"+R+"' data-month='"+V+"' data-year='"+X+"'><div class='entry' "+$+">"+R+"</div></td>";if(null!=b&&b>(te=new Date(X,V-1,R))&&(ee="<td class='calendarClickable "+Z+"' data-date='"+R+"' data-month='"+V+"' data-year='"+X+"'><div class='entry' "+$+">"+R+"</div></td>"),null!=N){var te=new Date(X,V-1,R);N<te&&(ee="<td class='calendarClickable "+Z+"' data-date='"+R+"' data-month='"+V+"' data-year='"+X+"'><div class='entry' "+$+">"+R+"</div></td>")}K.append(ee)}B.append(K)}var ae="";if(n.showNotes){var ne=c(),re=ne.length;if(re>0){ae=e("<ul class='dncalendar-note-list'></ul>");for(p=0;p<re;p++){var R=ne[p].date,le=ne[p].notes,de=le.length,oe="";if(oe+="<li class='date'>",oe+="<span>"+R+"</span> ",de>0){oe+=" : ";for(y=0;y<de;y++)oe+=le[y],de<=y&&(oe+=", ")}oe+="</li>",ae.append(oe)}}}x.append(Q),x.append(B),A.append(x),a.html(""),a.append(w),a.append(A),a.append(ae),a.addClass("ready")},f=function(e){for(var t=n.notes.length,a=0;a<t;a++){var r=n.notes[a].date.split("-"),l=new Date(r[0],r[1]-1,r[2]);if(l.getFullYear()==e.getFullYear()&&l.getMonth()==e.getMonth()&&l.getDate()==e.getDate())return!0}return!1},c=function(){for(var e=[],t=n.notes.length,a=0;a<t;a++){var l=n.notes[a].date.split("-"),d=new Date(l[0],l[1]-1,l[2]);if(d.getFullYear()==r.getFullYear()&&d.getMonth()==r.getMonth()){var o={};o.date=d.getDate(),o.notes=n.notes[a].note,e.push(o)}}return e},p=function(){var e=new Date(r.getFullYear(),r.getMonth()+1,1),t=e.getDate(),a=e.getMonth(),n=e.getFullYear();r=new Date(n,a,t),v()},D=function(){var e=new Date(r.getFullYear(),r.getMonth()-1,1),t=e.getDate(),a=e.getMonth(),n=e.getFullYear();r=new Date(n,a,t),v()},y=function(){a.on("click",".calendarClickable",function(){var t=e(this).data("date"),r=e(this).data("month"),l=e(this).data("year");n.dayClick.call(this,new Date(l,r-1,t),a)}),a.on("click",".dncalendar-prev-month",function(){D()}),a.on("click",".dncalendar-next-month",function(){p()})};return{build:function(){if(void 0!==(n=e.extend({},e.fn.dnCalendar.defaults,t)).chosenDate){var a=n.chosenDate.split("-");r=new Date(a[0],a[1]-1,a[2]),l=r}v(),y()},update:function(t){if(void 0!==(n=e.extend(n,t)).chosenDate){var a=n.chosenDate.split("-");r=new Date(a[0],a[1]-1,a[2]),l=r}v()}}},e.fn.dnCalendar.defaults={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayUseShortName:!1,monthUseShortName:!1,showNotes:!1,startWeek:"sunday",dayClick:function(e,t){}}}(jQuery);